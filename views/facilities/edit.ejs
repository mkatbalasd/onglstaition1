<div class="card card-form">
<form method="POST" action="/nagl/facilities/<%= facility.FacilityID %>">
  <div class="mb-3">
    <label class="form-label">رقم الهوية</label>
    <input type="text" name="IdentityNumber" class="form-control" value="<%= facility.IdentityNumber %>" required>
  </div>
  <div class="mb-3">
    <label class="form-label">اسم المنشأة</label>
    <input type="text" name="Name" class="form-control" value="<%= facility.Name %>" required>
  </div>
  <div class="mb-3">
    <label class="form-label">الاسم بالإنجليزية</label>
    <input type="text" name="EnglishName" class="form-control" value="<%= facility.EnglishName || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">رقم الترخيص</label>
    <input type="text" name="LicenseNumber" class="form-control" value="<%= facility.LicenseNumber || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">تاريخ إصدار الترخيص</label>
    <input type="text" name="LicenseIssueDate" class="form-control hijri-date" value="<%= facility.LicenseIssueDate || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">تاريخ انتهاء الترخيص</label>
    <input type="text" name="LicenseExpirationDate" class="form-control hijri-date" value="<%= facility.LicenseExpirationDate || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">نوع الترخيص</label>
    <div class="input-group">
      <select name="LicenseTypeID" id="LicenseTypeID" class="form-select">
        <% licenseTypes.forEach(lt => { %>
          <option value="<%= lt.LicenseTypeID %>" data-name="<%= lt.LicenseTypeNameAR %>" <%= facility.LicenseTypeID === lt.LicenseTypeID ? 'selected' : '' %>><%= lt.LicenseTypeNameAR %></option>
        <% }) %>
      </select>
      <a href="/nagl/license-types/new" target="_blank" rel="noopener" class="btn btn-outline-secondary btn-icon"><i class="bi bi-plus"></i></a>
    </div>
    <input type="hidden" name="LicenseType" id="LicenseType" value="<%= facility.LicenseType || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">مدينة الترخيص</label>
    <input type="text" name="LicenseCity" class="form-control" value="<%= facility.LicenseCity || '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">مدينة الترخيص بالإنجليزية</label>
    <input type="text" name="LicenseCityEn" class="form-control" value="<%= facility.LicenseCityEn || '' %>">
  </div>
  <button type="submit" class="btn btn-success">تحديث</button>
</form>
</div>
<script>
  const licenseSelect = document.getElementById('LicenseTypeID');
  const licenseTypeInput = document.getElementById('LicenseType');
  function updateLicenseType() {
    const selected = licenseSelect.options[licenseSelect.selectedIndex];
    licenseTypeInput.value = selected ? selected.getAttribute('data-name') : '';
  }
  licenseSelect.addEventListener('change', updateLicenseType);
  updateLicenseType();
</script>

